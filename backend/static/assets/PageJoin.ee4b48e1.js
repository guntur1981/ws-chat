import{a as ae,Q as le}from"./QPage.0d083d37.js";import{u as ne,c as ie,d as re,e as ue,f as oe,g as se,h as ce,i as K,a as de,Q as Y,b as J}from"./QItem.cca5d650.js";import{r as q,c,g as R,P as fe,s as G,b as me,h as g,a1 as ve,O as ge,E as he,a as pe,v as B,I as O,z as _,y as C,A as H,K as be,B as Se}from"./index.c2dbb6bd.js";import{c as j,f as ye,g as xe,Q as Fe,m as _e,h as L}from"./vm.e3ccacda.js";import{h as ze,u as Ce,a as qe}from"./format.f9684010.js";import{c as ke,d as Ve,Q as we}from"./QBtn.8bb4b6b6.js";function A(e,u,m,d){const n=[];return e.forEach(o=>{d(o)===!0?n.push(o):u.push({failedPropValidation:m,file:o})}),n}function $(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),G(e)}const Qe={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ae=["rejected"];function Ie({editable:e,dnd:u,getFileInput:m,addFilesToQueue:d}){const{props:n,emit:o,proxy:S}=R(),x=q(null),w=c(()=>n.accept!==void 0?n.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),Q=c(()=>parseInt(n.maxFiles,10)),V=c(()=>parseInt(n.maxTotalSize,10));function h(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&fe(t);else{const y=m();y&&y!==t.target&&y.click(t)}}function s(t){e.value&&t&&d(null,t)}function p(t,y,I,P){let l=Array.from(y||t.target.files);const b=[],k=()=>{b.length!==0&&o("rejected",b)};if(n.accept!==void 0&&w.value.indexOf("*/")===-1&&(l=A(l,b,"accept",r=>w.value.some(f=>r.type.toUpperCase().startsWith(f)||r.name.toUpperCase().endsWith(f))),l.length===0))return k();if(n.maxFileSize!==void 0){const r=parseInt(n.maxFileSize,10);if(l=A(l,b,"max-file-size",f=>f.size<=r),l.length===0)return k()}if(n.multiple!==!0&&l.length!==0&&(l=[l[0]]),l.forEach(r=>{r.__key=r.webkitRelativePath+r.lastModified+r.name+r.size}),P===!0){const r=I.map(f=>f.__key);l=A(l,b,"duplicate",f=>r.includes(f.__key)===!1)}if(l.length===0)return k();if(n.maxTotalSize!==void 0){let r=P===!0?I.reduce((f,U)=>f+U.size,0):0;if(l=A(l,b,"max-total-size",f=>(r+=f.size,r<=V.value)),l.length===0)return k()}if(typeof n.filter=="function"){const r=n.filter(l);l=A(l,b,"filter",f=>r.includes(f))}if(n.maxFiles!==void 0){let r=P===!0?I.length:0;if(l=A(l,b,"max-files",()=>(r++,r<=Q.value)),l.length===0)return k()}if(k(),l.length!==0)return l}function z(t){$(t),u.value!==!0&&(u.value=!0)}function i(t){G(t),(t.relatedTarget!==null||me.is.safari!==!0?t.relatedTarget!==x.value:document.elementsFromPoint(t.clientX,t.clientY).includes(x.value)===!1)===!0&&(u.value=!1)}function N(t){$(t);const y=t.dataTransfer.files;y.length!==0&&d(null,y),u.value=!1}function T(t){if(u.value===!0)return g("div",{ref:x,class:`q-${t}__dnd absolute-full`,onDragenter:$,onDragover:$,onDragleave:i,onDrop:N})}return Object.assign(S,{pickFiles:h,addFiles:s}),{pickFiles:h,addFiles:s,onDragover:z,onDragleave:i,processFiles:p,getDndNode:T,maxFilesNumber:Q,maxTotalSizeNumber:V}}var Pe=j({name:"QFile",inheritAttrs:!1,props:{...ne,...ie,...Qe,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...re,...Ae],setup(e,{slots:u,emit:m,attrs:d}){const{proxy:n}=R(),o=ue(),S=q(null),x=q(!1),w=oe(e),{pickFiles:Q,onDragover:V,onDragleave:h,processFiles:s,getDndNode:p}=Ie({editable:o.editable,dnd:x,getFileInput:M,addFilesToQueue:W}),z=se(e),i=c(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),N=c(()=>K(i.value)),T=c(()=>i.value.map(a=>a.name).join(", ")),t=c(()=>ze(i.value.reduce((a,v)=>a+v.size,0))),y=c(()=>({totalSize:t.value,filesNumber:i.value.length,maxFiles:e.maxFiles})),I=c(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:w.value,...d,id:o.targetUid.value,disabled:o.editable.value!==!0})),P=c(()=>"q-file q-field--auto-height"+(x.value===!0?" q-file--dnd":"")),l=c(()=>e.multiple===!0&&e.append===!0);function b(a){const v=i.value.slice();v.splice(a,1),r(v)}function k(a){const v=i.value.indexOf(a);v>-1&&b(v)}function r(a){m("update:modelValue",e.multiple===!0?a:a[0])}function f(a){a.keyCode===13&&ge(a)}function U(a){(a.keyCode===13||a.keyCode===32)&&Q(a)}function M(){return S.value}function W(a,v){const F=s(a,v,i.value,l.value),E=M();E!=null&&(E.value=""),F!==void 0&&((e.multiple===!0?e.modelValue&&F.every(te=>i.value.includes(te)):e.modelValue===F[0])||r(l.value===!0?i.value.concat(F):F))}function D(){return[g("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function Z(){if(u.file!==void 0)return i.value.length===0?D():i.value.map((v,F)=>u.file({index:F,file:v,ref:this}));if(u.selected!==void 0)return i.value.length===0?D():u.selected({files:i.value,ref:this});if(e.useChips===!0)return i.value.length===0?D():i.value.map((v,F)=>g(ae,{key:"file-"+F,removable:o.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{b(F)}},()=>g("span",{class:"ellipsis",textContent:v.name})));const a=e.displayValue!==void 0?e.displayValue:T.value;return a.length!==0?[g("div",{class:e.inputClass,style:e.inputStyle,textContent:a})]:D()}function ee(){const a={ref:S,...I.value,...z.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:W};return e.multiple===!0&&(a.multiple=!0),g("input",a)}return Object.assign(o,{fieldClass:P,emitValue:r,hasValue:N,inputRef:S,innerValue:i,floatingLabel:c(()=>N.value===!0||K(e.displayValue)),computedCounter:c(()=>{if(e.counterLabel!==void 0)return e.counterLabel(y.value);const a=e.maxFiles;return`${i.value.length}${a!==void 0?" / "+a:""} (${t.value})`}),getControlChild:()=>p("file"),getControl:()=>{const a={ref:o.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return o.editable.value===!0&&Object.assign(a,{onDragover:V,onDragleave:h,onKeydown:f,onKeyup:U}),g("div",a,[ee()].concat(Z()))}}),Object.assign(n,{removeAtIndex:b,removeFile:k,getNativeElement:()=>S.value}),ve(n,"nativeEl",()=>S.value),ce(o)}}),je=j({name:"QAvatar",props:{...ye,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(e,{slots:u}){const m=xe(e),d=c(()=>"q-avatar"+(e.color?` bg-${e.color}`:"")+(e.textColor?` text-${e.textColor} q-chip--colored`:"")+(e.square===!0?" q-avatar--square":e.rounded===!0?" rounded-borders":"")),n=c(()=>e.fontSize?{fontSize:e.fontSize}:null);return()=>{const o=e.icon!==void 0?[g(Fe,{name:e.icon})]:void 0;return g("div",{class:d.value,style:m.value},[g("div",{class:"q-avatar__content row flex-center overflow-hidden",style:n.value},_e(u.default,o))])}}}),X=j({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(e,{slots:u}){const m=c(()=>`q-card__section q-card__section--${e.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>g(e.tag,{class:m.value},L(u.default))}}),Ne=j({name:"QCardActions",props:{...ke,vertical:Boolean},setup(e,{slots:u}){const m=Ve(e),d=c(()=>`q-card__actions ${m.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>g("div",{class:d.value},L(u.default))}}),De=j({name:"QCard",props:{...Ce,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(e,{slots:u}){const{proxy:{$q:m}}=R(),d=qe(e,m),n=c(()=>"q-card"+(d.value===!0?" q-card--dark q-dark":"")+(e.bordered===!0?" q-card--bordered":"")+(e.square===!0?" q-card--square no-border-radius":"")+(e.flat===!0?" q-card--flat no-shadow":""));return()=>g(e.tag,{class:n.value},L(u.default))}});const Be=["src"],Oe=H("div",{class:"text-center text-h6"}," Sorry, your browser does not support websocket... \u{1F972}\u{1F64F} ",-1),Me={__name:"PageJoin",setup(e){const u=q(null),m=he(),d=q(!0),n=q(!1),o=q(""),S=q(""),x=q("blank-photo.png");function w(V){let s,p;const z=new Image;z.onload=()=>{s=z.height,p=z.width,p>s?p>100&&(s*=100/p,p=100):s>100&&(p*=100/s,s=100);const i=document.createElement("canvas");i.height=s,i.width=p,i.getContext("2d").drawImage(z,0,0,p,s),x.value=i.toDataURL("image/jpeg")},z.src=URL.createObjectURL(V)}function Q(){n.value=!0,m.join(S.value,o.value,x.value)}return pe(()=>{n.value=!1,d.value=window.WebSocket}),(V,h)=>(B(),O(le,null,{default:_(()=>[C(De,{class:"absolute-center bg-secondary my-card text-white"},{default:_(()=>[d.value?(B(),O(X,{key:0},{default:_(()=>[C(Pe,{accept:".jpg, image/*",ref_key:"refFileInput",ref:u,style:{display:"none"},"onUpdate:modelValue":w},null,512),C(de,null,{default:_(()=>[C(Y,{avatar:""},{default:_(()=>[C(je,{class:"shadow-5",color:"blue-grey-2",size:"70px"},{default:_(()=>[H("img",{class:"cursor-pointer",onClick:h[0]||(h[0]=s=>u.value.pickFiles()),src:x.value},null,8,Be)]),_:1})]),_:1}),C(Y,null,{default:_(()=>[C(J,{"bg-color":"blue-grey-2",dense:"",label:"Your name",filled:"",rules:[s=>!!s||"Name is required"],modelValue:S.value,"onUpdate:modelValue":h[1]||(h[1]=s=>S.value=s)},null,8,["rules","modelValue"]),C(J,{"bg-color":"blue-grey-2",dense:"",label:"Location",filled:"",modelValue:o.value,"onUpdate:modelValue":h[2]||(h[2]=s=>o.value=s)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):be("",!0),d.value?(B(),O(Ne,{key:1,vertical:""},{default:_(()=>[C(we,{class:"bg-primary",onClick:Q,flat:"",loading:n.value},{default:_(()=>[Se("Join")]),_:1},8,["loading"])]),_:1})):(B(),O(X,{key:2},{default:_(()=>[Oe]),_:1}))]),_:1})]),_:1}))}};export{Me as default};
